# Human-to-Human CAPTCHA (H2H-CAPTCHA)

> **"기계가 아닌 사람이 직접 검증하는 실시간 캡차 시스템"**

H2H-CAPTCHA는 기존의 자동화된 튜링 테스트(신호등 찾기 등)를 실시간 인간 상호작용으로 대체하는 혁신적인 보안 솔루션입니다. 사용자("Client")는 실제 사람 검증자("Validator")와 매칭되어 대화하거나 게임을 하며 자신이 사람임을 증명합니다.

---

## 🏗 시스템 아키텍처

이 시스템은 **Spring Boot**와 **WebSocket**을 기반으로 한 이벤트 기반 아키텍처로 구축되었습니다.

### 1. 백엔드 (Kotlin + Spring Boot)
-   **WebSocket (STOMP)**: 실시간 양방향 통신을 처리합니다.
-   **매칭 서비스 (Matching Service)**:
    *   Client와 Validator의 대기열을 독립적으로 관리합니다.
    *   즉각적인 1:1 매칭을 수행하며 세션 생명주기(연결, 해제, 타임아웃)를 관리합니다.
-   **인메모리 관리**: 데이터베이스 없이 모든 데이터를 메모리(`ConcurrentHashMap`)에서 처리하여 속도를 극대화합니다. 클라이언트의 블랙리스트와 실패 이력은 세션이 끊겨도 일정 시간(30분) 유지되어 보안을 강화합니다.

### 2. 프론트엔드 (Vanilla JS + HTML5)
-   **화면 미러링**:
    *   Client의 마우스 좌표와 화면 해상도를 캡처합니다.
    *   Validator 대시보드는 Client의 화면 비율(Aspect Ratio)에 맞춰 동적으로 크기를 조절하여 픽셀 단위로 정확하게 관제합니다.
-   **인터랙티브 캔버스**:
    *   이중 좌표계: 화면 기준 전역 좌표(Global)와 캔버스 기준 지역 좌표(Local)를 동시에 전송하여 다양한 화면 크기에서도 정확한 드로잉 동기화를 보장합니다.

---

## 🎮 인터랙티브 챌린지

시스템은 Validator가 제어하는 네 가지 검증 모드를 지원합니다:

1.  **🖱️ 마우스 트래킹 (수동적 검증)**
    -   **로직**: Validator가 Client의 자연스러운 마우스 움직임을 관찰합니다.
    -   **목표**: 매크로 특유의 직선 이동이나 순간 이동을 감지합니다.

2.  **✏️ 그림 그리기 (능동적 검증)**
    -   **로직**: Validator가 주제어(예: "사과")를 던지면 Client가 캔버스에 그립니다.
    -   **목표**: 사람의 창의성과 미세한 운동 제어 능력을 확인합니다.

3.  **👊 가위바위보 (반응 속도 검증)**
    -   **로직**: Validator가 패(예: "바위")를 내면, Client는 정해진 시간 내에 이기는 패("보")를 내야 합니다.
    -   **목표**: 규칙 이해 능력과 인지 반응을 테스트합니다.

4.  **💬 실시간 채팅 (튜링 테스트)**
    -   **로직**: 자유 형식의 텍스트 대화. "입력 중..." 표시를 포함하여 실시간성을 높였습니다.
    -   **목표**: 고도화된 언어 상호작용을 통한 최종 검증.

---

## 🚀 시작하기

### 필수 조건
-   **Java 21** 설치 (또는 Docker)
-   8080 포트 가용성

### Docker로 실행 (권장)
```bash
docker-compose up --build
```

### 수동 실행
```bash
./gradlew bootRun
```

### 사용 방법
1.  `http://localhost:8080`에 접속합니다.
2.  **탭 1**: "사용자로 참여"를 선택합니다.
3.  **탭 2**: "검증자로 참여"를 선택합니다.
4.  즉시 매칭이 완료되며, 검증자는 화면을 지켜보며 미션을 부여할 수 있습니다.

---

## 🛡️ 보안 및 개인정보
-   **UUID 기반 라우팅**: 모든 세션은 무작위 UUID를 사용하여 안전하게 메시지를 전달합니다.
-   **철저한 고립**: Client끼리는 절대 통신할 수 없습니다.
-   **개인정보 보호**: IP를 기록하지 않으며 세션 종료 시 모든 데이터가 즉시 파기됩니다.

---
© 2025 H2H Captcha Project.
