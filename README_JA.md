<p align="center">
  <a href="README.md">English</a> |
  <a href="README_KO.md">한국어</a> |
  <a href="README_JA.md">日本語</a> |
  <a href="README_ZH.md">中文</a> |
  <a href="README_FR.md">Français</a>
</p>

<p align="center">
  <img src="src/main/resources/image/logo.png" alt="H2H-CAPTCHA Logo" width="200" />
</p>

# Human-to-Human CAPTCHA (H2H-CAPTCHA)

> **「人による、人のためのリアルタイム検証」**

H2H-CAPTCHAは、従来の自動化されたチューリングテスト（信号機の識別など）をリアルタイムの人間同士の相互作用に置き換える革新的なセキュリティソリューションです。ユーザー（「クライアント」）は実際の人間である検証者（「バリデータ」）とペアになり、対話形式のタスクを実行します。

---

## 🌍 言語

- [English](README.md)
- [한국어 (Korean)](README_KO.md)
- [日本語 (Japanese)](README_JA.md)
- [中文 (Chinese)](README_ZH.md)
- [Français (French)](README_FR.md)

---

## 🏗 アーキテクチャ

このシステムは、**Spring Boot**と**WebSockets**を使用した堅牢なイベント駆動型アーキテクチャ上に構築されています。

### 1. バックエンド (Kotlin + Spring Boot)
-   **WebSocket (STOMP)**: リアルタイムの双方向通信を処理します。
-   **マッチングサービス**:
    -   クライアントとバリデータの待機列を個別に管理します。
    -   即時の1:1マッチングを実行します。
    -   セッションのライフサイクル（接続、切断、タイムアウト）を管理します。
-   **インメモリ管理**: 速度とプライバシーを最大化するため、すべてのデータをメモリ（`ConcurrentHashMap`）で処理し、個人データを永続化しません。

### 2. フロントエンド (Vanilla JS + HTML5)
-   **画面ミラーリング**:
    -   クライアントのマウス座標と画面解像度をキャプチャします。
    -   バリデータのダッシュボードは、クライアントのアスペクト比に合わせて動的にリサイズされ、正確な監視を可能にします。
-   **インタラクティブキャンバス**:
    -   二重座標系：画面全体の相対座標（Global）とキャンバス内の相対座標（Local）を個別に送信し、異なる画面サイズ間でも正確なお絵かき同期を実現します。

---

## 🎮 インタラクティブ・ミッション

バリデータが制御する4つの検証モードをサポートしています：

1.  **🖱️ マウストラッキング (受動的検証)**
    -   **ロジック**: バリデータはクライアントの自然なマウスの動きを観察します。
    -   **目的**: ボット特有の直線的な動きや瞬間移動を検出します。

2.  **✏️ お絵かき (能動的検証)**
    -   **ロジック**: バリデータがお題（例：「リンゴ」）を指定し、クライアントがキャンバスに描きます。
    -   **目的**: 人間の創造性と運動制御能力を確認します。

3.  **👊 じゃんけん (反応速度検証)**
    -   **ロジック**: バリデータが手（例：「グー」）を出し、クライアントはそれに勝つ手（「パー」）を出すよう誘導されます。
    -   **目的**: ルールの理解と認知的反応をテストします。

4.  **💬 チャット (チューリングテスト)**
    -   **ロジック**: 自由形式のテキスト会話。リアルタイムの「入力中...」表示が含まれます。
    -   **目的**: 高度な言語相互作用による最終検証。

---

## 🚀 はじめに

### 前提条件
-   **Java 21** (または Docker)
-   ポート 8080 が利用可能であること

### Dockerで実行 (推奨)
```bash
docker-compose up --build
```

### 手動で実行
```bash
./gradlew bootRun
```

### 使い方
1.  `http://localhost:8080` を開きます。
2.  **タブ 1**: 「ユーザーとして参加（Client）」を選択します。
3.  **タブ 2**: 「検証者として参加（Validator）」を選択します。
4.  システムが即座にマッチングを行います。
5.  バリデータコンソールを使用してタスクを切り替え、クライアントを検証します。

---

## 🛡️ セキュリティ機能
-   **UUIDベースのルーティング**: 各セッションは一意のUUIDを作成し、安全なメッセージルーティングを行います。`localStorage`を使用することで、再読み込み後も同一性が維持され、バリデータのブラックリスト機能が正しく動作します。
-   **隔離**: クライアント同士が通信することはできません。
-   **プライバシー**: IPログや永続的な保存は行われません。データはアクティブなWebSocketセッション中のみ存在します。

---
© 2025 H2H Captcha Project.
